/* -------------------------------------------------------------------------- */
/* (c) ali@balarabe.com                                 [libex_dtime_tests.c] */
/* -------------------------------------------------------------------------- */

#include "libex_c_precompiled.h"
#include "libex_c_tests_.h"
#if !defined INCLUDED_LIBEX_DTIME_TESTS_C
#define      INCLUDED_LIBEX_DTIME_TESTS_C

#include <limits.h>  /* for INT_MAX           */
#include <stdio.h>   /* for printf()          */
#include <string.h>  /* for memset() strcmp() */

#include "libex_.h"
#include "libex_call_.h"
#include "libex_const_.h"
#include "libex_debug_.h"
#include "libex_error_.h"
#include "libex_libc_.h"
#include "libex_macro_.h"

#if PLATFORM_WIN32
#include <tchar.h>
#include <windows.h>
#include "libex_win32_.h"
#endif

#include "libex_dtime_.h"

#if defined __cplusplus_cli
#pragma unmanaged
#endif

#if defined __GNUC__ && !defined __MINGW32__
#pragma GCC diagnostic ignored "-Wredundant-decls"
#endif

#define DTIME_EQUAL( DTIME_1_, DTIME_2_ )     \
    (DTIME_1_.year   == DTIME_2_.year   &&    \
     DTIME_1_.month  == DTIME_2_.month  &&    \
     DTIME_1_.day    == DTIME_2_.day    &&    \
     DTIME_1_.hour   == DTIME_2_.hour   &&    \
     DTIME_1_.minute == DTIME_2_.minute &&    \
     DTIME_1_.second == DTIME_2_.second)  /*#*/

#define NULL_DATE  { 0, 0, 0, 0, 0, 0}

#define YEAR  0xFFFF


/* -------------------------------------------------------------------------- */
/* Constructors:                                                              */


/* Construct a date/time object from given year, month and day numbers.       */
PUBLIC dtime_t  date_init(                                                 /*C*/
    const int  year_,                                                      /*-*/
    const int  month_,                                                     /*-*/
    const int  day_ );                                                     /*-*/

static void  _test_lx_date( void ) {                                       /*F*/
    static struct  _test_t {
        int  year_;
        int  month_;
        int  day_;
        dtime_t  check;
    }
    const  tests[] = {

        /* year_ 0 to 49 returns years from 2000 to 2049 */
        {    0,  1,  2,  {2000,  1,  2, 0, 0, 0} },
        {   49,  1,  2,  {2049,  1,  2, 0, 0, 0} },

        /* year_ 50 to 99 returns years 1950 to 1999 */
        {   50,  1,  2,  {1950,  1,  2, 0, 0, 0} },
        {   99,  1,  2,  {1999,  1,  2, 0, 0, 0} },

        /* test minimum and maximum year */
        {  100,  1,  1,  { 100,  1,  1, 0, 0, 0} },
        { 9999, 12, 31,  {9999, 12, 31, 0, 0, 0} },

        /* test month */
        { 2015,  1, 31, { 2015,  1, 31, 0, 0, 0} },
        { 2015,  2, 28, { 2015,  2, 28, 0, 0, 0} },
        { 2015,  3, 31, { 2015,  3, 31, 0, 0, 0} },
        { 2015,  4, 30, { 2015,  4, 30, 0, 0, 0} },
        { 2015,  5, 31, { 2015,  5, 31, 0, 0, 0} },
        { 2015,  6, 30, { 2015,  6, 30, 0, 0, 0} },
        { 2015,  7, 31, { 2015,  7, 31, 0, 0, 0} },
        { 2015,  8, 31, { 2015,  8, 31, 0, 0, 0} },
        { 2015,  9, 30, { 2015,  9, 30, 0, 0, 0} },
        { 2015, 10, 31, { 2015, 10, 31, 0, 0, 0} },
        { 2015, 11, 30, { 2015, 11, 30, 0, 0, 0} },
        { 2015, 12, 31, { 2015, 12, 31, 0, 0, 0} },

        /* test day */
        { 2015, 1,  1, {2015, 1,  1, 0, 0, 0} },
        { 2015, 1,  2, {2015, 1,  2, 0, 0, 0} },
        { 2015, 1,  3, {2015, 1,  3, 0, 0, 0} },
        { 2015, 1,  4, {2015, 1,  4, 0, 0, 0} },
        { 2015, 1,  5, {2015, 1,  5, 0, 0, 0} },
        { 2015, 1,  6, {2015, 1,  6, 0, 0, 0} },
        { 2015, 1,  7, {2015, 1,  7, 0, 0, 0} },
        { 2015, 1,  8, {2015, 1,  8, 0, 0, 0} },
        { 2015, 1,  9, {2015, 1,  9, 0, 0, 0} },
        { 2015, 1, 10, {2015, 1, 10, 0, 0, 0} },
        { 2015, 1, 11, {2015, 1, 11, 0, 0, 0} },
        { 2015, 1, 12, {2015, 1, 12, 0, 0, 0} },
        { 2015, 1, 13, {2015, 1, 13, 0, 0, 0} },
        { 2015, 1, 14, {2015, 1, 14, 0, 0, 0} },
        { 2015, 1, 15, {2015, 1, 15, 0, 0, 0} },
        { 2015, 1, 16, {2015, 1, 16, 0, 0, 0} },
        { 2015, 1, 17, {2015, 1, 17, 0, 0, 0} },
        { 2015, 1, 18, {2015, 1, 18, 0, 0, 0} },
        { 2015, 1, 19, {2015, 1, 19, 0, 0, 0} },
        { 2015, 1, 20, {2015, 1, 20, 0, 0, 0} },
        { 2015, 1, 21, {2015, 1, 21, 0, 0, 0} },
        { 2015, 1, 22, {2015, 1, 22, 0, 0, 0} },
        { 2015, 1, 23, {2015, 1, 23, 0, 0, 0} },
        { 2015, 1, 24, {2015, 1, 24, 0, 0, 0} },
        { 2015, 1, 25, {2015, 1, 25, 0, 0, 0} },
        { 2015, 1, 26, {2015, 1, 26, 0, 0, 0} },
        { 2015, 1, 27, {2015, 1, 27, 0, 0, 0} },
        { 2015, 1, 28, {2015, 1, 28, 0, 0, 0} },
        { 2015, 1, 29, {2015, 1, 29, 0, 0, 0} },
        { 2015, 1, 30, {2015, 1, 30, 0, 0, 0} },
        { 2015, 1, 31, {2015, 1, 31, 0, 0, 0} },

        /* test Feb-29th of leap years */
        {  104, 2, 29, { 104, 2, 29, 0, 0, 0} },  /* min leap yr */
        { 1908, 2, 29, {1908, 2, 29, 0, 0, 0} },
        { 2012, 2, 29, {2012, 2, 29, 0, 0, 0} },
        { 9996, 2, 29, {9996, 2, 29, 0, 0, 0} },  /* max leap yr */

        /* invalid dates (result in a null date/time object) */

        {     0,  0, 0, NULL_DATE },  /* null */

        {    -1,  1, 1, NULL_DATE },  /* invalid year */
        { 10000,  1, 1, NULL_DATE },

        { 2015,  0, 1, NULL_DATE },  /* invalid month */
        { 2015, -1, 1, NULL_DATE },
        { 2015, 13, 1, NULL_DATE },
        { 2015, 99, 1, NULL_DATE },

        { 2015,  1, 32, NULL_DATE },  /* invalid day of month */
        { 2015,  2, 29, NULL_DATE },
        { 2015,  3, 32, NULL_DATE },
        { 2015,  4, 31, NULL_DATE },
        { 2015,  5, 32, NULL_DATE },
        { 2015,  6, 31, NULL_DATE },
        { 2015,  7, 32, NULL_DATE },
        { 2015,  8, 32, NULL_DATE },
        { 2015,  9, 31, NULL_DATE },
        { 2015, 10, 32, NULL_DATE },
        { 2015, 11, 31, NULL_DATE },
        { 2015, 12, 32, NULL_DATE },

        { 2015,  1, -1, NULL_DATE },  /* invalid day */
        { 2015,  1,  0, NULL_DATE },
        { 2015,  1, 99, NULL_DATE },

        { 0xFFFF, 0xFF, 0xFF, NULL_DATE }  /* stop */
    };
    int  i = 0;
    do {
        const int      year_  = tests[i].year_;
        const int      month_ = tests[i].month_;
        const int      day_   = tests[i].day_;
        const dtime_t  check  = tests[i].check;
        const dtime_t  result = date_init(year_, month_, day_);

        if (!DTIME_EQUAL(check, result)) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (0xFFFF != tests[++i].year_);
} /* _test_lx_date */


/* Construct a date/time object from numeric year, month, date, hour, etc.    */
PUBLIC dtime_t  dtime_init(                                                /*C*/
    const int  year_,                                                      /*-*/
    const int  month_,                                                     /*-*/
    const int  day_,                                                       /*-*/
    const int  hour_,                                                      /*-*/
    const int  minute_,                                                    /*-*/
    const int  second_ );                                                  /*-*/

static void  _test_dtime_init( void ) {                                    /*F*/
    static struct  _test_t {
        int         year_;
        int         month_;
        int         day_;
        int         hour_;
        int         minute_;
        int         second_;
        dtime_t  check;
    }
    const  tests[] = {

        /* year_ 0 to 49 returns years from 2000 to 2049 */

        {  0, 1, 2,  0,  0,  0, {2000, 1, 2,  0,  0,  0} },
        {  0, 1, 2, 11, 22, 33, {2000, 1, 2, 11, 22, 33} },
        {  0, 1, 2, 23, 59, 59, {2000, 1, 2, 23, 59, 59} },

        { 49, 1, 2,  0,  0,  0, {2049, 1, 2,  0,  0,  0} },
        { 49, 1, 2, 11, 22, 33, {2049, 1, 2, 11, 22, 33} },
        { 49, 1, 2, 23, 59, 59, {2049, 1, 2, 23, 59, 59} },

        /* year_ 50 to 99 returns years 1950 to 1999 */

        { 50, 1, 2,  0,  0,  0, {1950, 1, 2,  0,  0,  0} },
        { 50, 1, 2, 11, 22, 33, {1950, 1, 2, 11, 22, 33} },
        { 50, 1, 2, 23, 59, 59, {1950, 1, 2, 23, 59, 59} },

        { 99, 1, 2,  0,  0,  0, {1999, 1, 2,  0,  0,  0} },
        { 99, 1, 2, 11, 22, 33, {1999, 1, 2, 11, 22, 33} },
        { 99, 1, 2, 23, 59, 59, {1999, 1, 2, 23, 59, 59} },

        /* test minimum and maximum year */

        { 100, 1, 1,  0,  0,  0, { 100, 1, 1,  0,  0,  0} },
        { 100, 1, 1, 11, 22, 33, { 100, 1, 1, 11, 22, 33} },
        { 100, 1, 1, 23, 59, 59, { 100, 1, 1, 23, 59, 59} },

        { 9999, 12, 31,  0,  0,  0, {9999, 12, 31,  0,  0,  0} },
        { 9999, 12, 31, 11, 22, 33, {9999, 12, 31, 11, 22, 33} },
        { 9999, 12, 31, 23, 59, 59, {9999, 12, 31, 23, 59, 59} },

        /* test month */

        { 2015,  1, 31, 0, 0, 0, {2015,  1, 31, 0, 0, 0} },
        { 2015,  2, 28, 0, 0, 0, {2015,  2, 28, 0, 0, 0} },
        { 2015,  3, 31, 0, 0, 0, {2015,  3, 31, 0, 0, 0} },
        { 2015,  4, 30, 0, 0, 0, {2015,  4, 30, 0, 0, 0} },
        { 2015,  5, 31, 0, 0, 0, {2015,  5, 31, 0, 0, 0} },
        { 2015,  6, 30, 0, 0, 0, {2015,  6, 30, 0, 0, 0} },
        { 2015,  7, 31, 0, 0, 0, {2015,  7, 31, 0, 0, 0} },
        { 2015,  8, 31, 0, 0, 0, {2015,  8, 31, 0, 0, 0} },
        { 2015,  9, 30, 0, 0, 0, {2015,  9, 30, 0, 0, 0} },
        { 2015, 10, 31, 0, 0, 0, {2015, 10, 31, 0, 0, 0} },
        { 2015, 11, 30, 0, 0, 0, {2015, 11, 30, 0, 0, 0} },
        { 2015, 12, 31, 0, 0, 0, {2015, 12, 31, 0, 0, 0} },

        { 2015,  1, 31, 11, 22, 33, {2015,  1, 31, 11, 22, 33} },
        { 2015,  2, 28, 11, 22, 33, {2015,  2, 28, 11, 22, 33} },
        { 2015,  3, 31, 11, 22, 33, {2015,  3, 31, 11, 22, 33} },
        { 2015,  4, 30, 11, 22, 33, {2015,  4, 30, 11, 22, 33} },
        { 2015,  5, 31, 11, 22, 33, {2015,  5, 31, 11, 22, 33} },
        { 2015,  6, 30, 11, 22, 33, {2015,  6, 30, 11, 22, 33} },
        { 2015,  7, 31, 11, 22, 33, {2015,  7, 31, 11, 22, 33} },
        { 2015,  8, 31, 11, 22, 33, {2015,  8, 31, 11, 22, 33} },
        { 2015,  9, 30, 11, 22, 33, {2015,  9, 30, 11, 22, 33} },
        { 2015, 10, 31, 11, 22, 33, {2015, 10, 31, 11, 22, 33} },
        { 2015, 11, 30, 11, 22, 33, {2015, 11, 30, 11, 22, 33} },
        { 2015, 12, 31, 11, 22, 33, {2015, 12, 31, 11, 22, 33} },

        { 2015,  1, 31, 23, 59, 59, {2015,  1, 31, 23, 59, 59} },
        { 2015,  2, 28, 23, 59, 59, {2015,  2, 28, 23, 59, 59} },
        { 2015,  3, 31, 23, 59, 59, {2015,  3, 31, 23, 59, 59} },
        { 2015,  4, 30, 23, 59, 59, {2015,  4, 30, 23, 59, 59} },
        { 2015,  5, 31, 23, 59, 59, {2015,  5, 31, 23, 59, 59} },
        { 2015,  6, 30, 23, 59, 59, {2015,  6, 30, 23, 59, 59} },
        { 2015,  7, 31, 23, 59, 59, {2015,  7, 31, 23, 59, 59} },
        { 2015,  8, 31, 23, 59, 59, {2015,  8, 31, 23, 59, 59} },
        { 2015,  9, 30, 23, 59, 59, {2015,  9, 30, 23, 59, 59} },
        { 2015, 10, 31, 23, 59, 59, {2015, 10, 31, 23, 59, 59} },
        { 2015, 11, 30, 23, 59, 59, {2015, 11, 30, 23, 59, 59} },
        { 2015, 12, 31, 23, 59, 59, {2015, 12, 31, 23, 59, 59} },

        /* test day */

        { 2015, 1,  1, 0, 0, 0, {2015, 1,  1, 0, 0, 0} },
        { 2015, 1,  2, 0, 0, 0, {2015, 1,  2, 0, 0, 0} },
        { 2015, 1,  3, 0, 0, 0, {2015, 1,  3, 0, 0, 0} },
        { 2015, 1,  4, 0, 0, 0, {2015, 1,  4, 0, 0, 0} },
        { 2015, 1,  5, 0, 0, 0, {2015, 1,  5, 0, 0, 0} },
        { 2015, 1,  6, 0, 0, 0, {2015, 1,  6, 0, 0, 0} },
        { 2015, 1,  7, 0, 0, 0, {2015, 1,  7, 0, 0, 0} },
        { 2015, 1,  8, 0, 0, 0, {2015, 1,  8, 0, 0, 0} },
        { 2015, 1,  9, 0, 0, 0, {2015, 1,  9, 0, 0, 0} },
        { 2015, 1, 10, 0, 0, 0, {2015, 1, 10, 0, 0, 0} },
        { 2015, 1, 11, 0, 0, 0, {2015, 1, 11, 0, 0, 0} },
        { 2015, 1, 12, 0, 0, 0, {2015, 1, 12, 0, 0, 0} },
        { 2015, 1, 13, 0, 0, 0, {2015, 1, 13, 0, 0, 0} },
        { 2015, 1, 14, 0, 0, 0, {2015, 1, 14, 0, 0, 0} },
        { 2015, 1, 15, 0, 0, 0, {2015, 1, 15, 0, 0, 0} },
        { 2015, 1, 16, 0, 0, 0, {2015, 1, 16, 0, 0, 0} },
        { 2015, 1, 17, 0, 0, 0, {2015, 1, 17, 0, 0, 0} },
        { 2015, 1, 18, 0, 0, 0, {2015, 1, 18, 0, 0, 0} },
        { 2015, 1, 19, 0, 0, 0, {2015, 1, 19, 0, 0, 0} },
        { 2015, 1, 20, 0, 0, 0, {2015, 1, 20, 0, 0, 0} },
        { 2015, 1, 21, 0, 0, 0, {2015, 1, 21, 0, 0, 0} },
        { 2015, 1, 22, 0, 0, 0, {2015, 1, 22, 0, 0, 0} },
        { 2015, 1, 23, 0, 0, 0, {2015, 1, 23, 0, 0, 0} },
        { 2015, 1, 24, 0, 0, 0, {2015, 1, 24, 0, 0, 0} },
        { 2015, 1, 25, 0, 0, 0, {2015, 1, 25, 0, 0, 0} },
        { 2015, 1, 26, 0, 0, 0, {2015, 1, 26, 0, 0, 0} },
        { 2015, 1, 27, 0, 0, 0, {2015, 1, 27, 0, 0, 0} },
        { 2015, 1, 28, 0, 0, 0, {2015, 1, 28, 0, 0, 0} },
        { 2015, 1, 29, 0, 0, 0, {2015, 1, 29, 0, 0, 0} },
        { 2015, 1, 30, 0, 0, 0, {2015, 1, 30, 0, 0, 0} },
        { 2015, 1, 31, 0, 0, 0, {2015, 1, 31, 0, 0, 0} },

        { 2015, 1,  1, 11, 22, 33, {2015, 1,  1, 11, 22, 33} },
        { 2015, 1,  2, 11, 22, 33, {2015, 1,  2, 11, 22, 33} },
        { 2015, 1,  3, 11, 22, 33, {2015, 1,  3, 11, 22, 33} },
        { 2015, 1,  4, 11, 22, 33, {2015, 1,  4, 11, 22, 33} },
        { 2015, 1,  5, 11, 22, 33, {2015, 1,  5, 11, 22, 33} },
        { 2015, 1,  6, 11, 22, 33, {2015, 1,  6, 11, 22, 33} },
        { 2015, 1,  7, 11, 22, 33, {2015, 1,  7, 11, 22, 33} },
        { 2015, 1,  8, 11, 22, 33, {2015, 1,  8, 11, 22, 33} },
        { 2015, 1,  9, 11, 22, 33, {2015, 1,  9, 11, 22, 33} },
        { 2015, 1, 10, 11, 22, 33, {2015, 1, 10, 11, 22, 33} },
        { 2015, 1, 11, 11, 22, 33, {2015, 1, 11, 11, 22, 33} },
        { 2015, 1, 12, 11, 22, 33, {2015, 1, 12, 11, 22, 33} },
        { 2015, 1, 13, 11, 22, 33, {2015, 1, 13, 11, 22, 33} },
        { 2015, 1, 14, 11, 22, 33, {2015, 1, 14, 11, 22, 33} },
        { 2015, 1, 15, 11, 22, 33, {2015, 1, 15, 11, 22, 33} },
        { 2015, 1, 16, 11, 22, 33, {2015, 1, 16, 11, 22, 33} },
        { 2015, 1, 17, 11, 22, 33, {2015, 1, 17, 11, 22, 33} },
        { 2015, 1, 18, 11, 22, 33, {2015, 1, 18, 11, 22, 33} },
        { 2015, 1, 19, 11, 22, 33, {2015, 1, 19, 11, 22, 33} },
        { 2015, 1, 20, 11, 22, 33, {2015, 1, 20, 11, 22, 33} },
        { 2015, 1, 21, 11, 22, 33, {2015, 1, 21, 11, 22, 33} },
        { 2015, 1, 22, 11, 22, 33, {2015, 1, 22, 11, 22, 33} },
        { 2015, 1, 23, 11, 22, 33, {2015, 1, 23, 11, 22, 33} },
        { 2015, 1, 24, 11, 22, 33, {2015, 1, 24, 11, 22, 33} },
        { 2015, 1, 25, 11, 22, 33, {2015, 1, 25, 11, 22, 33} },
        { 2015, 1, 26, 11, 22, 33, {2015, 1, 26, 11, 22, 33} },
        { 2015, 1, 27, 11, 22, 33, {2015, 1, 27, 11, 22, 33} },
        { 2015, 1, 28, 11, 22, 33, {2015, 1, 28, 11, 22, 33} },
        { 2015, 1, 29, 11, 22, 33, {2015, 1, 29, 11, 22, 33} },
        { 2015, 1, 30, 11, 22, 33, {2015, 1, 30, 11, 22, 33} },
        { 2015, 1, 31, 11, 22, 33, {2015, 1, 31, 11, 22, 33} },

        { 2015, 1,  1, 23, 59, 59, {2015, 1,  1, 23, 59, 59} },
        { 2015, 1,  2, 23, 59, 59, {2015, 1,  2, 23, 59, 59} },
        { 2015, 1,  3, 23, 59, 59, {2015, 1,  3, 23, 59, 59} },
        { 2015, 1,  4, 23, 59, 59, {2015, 1,  4, 23, 59, 59} },
        { 2015, 1,  5, 23, 59, 59, {2015, 1,  5, 23, 59, 59} },
        { 2015, 1,  6, 23, 59, 59, {2015, 1,  6, 23, 59, 59} },
        { 2015, 1,  7, 23, 59, 59, {2015, 1,  7, 23, 59, 59} },
        { 2015, 1,  8, 23, 59, 59, {2015, 1,  8, 23, 59, 59} },
        { 2015, 1,  9, 23, 59, 59, {2015, 1,  9, 23, 59, 59} },
        { 2015, 1, 10, 23, 59, 59, {2015, 1, 10, 23, 59, 59} },
        { 2015, 1, 11, 23, 59, 59, {2015, 1, 11, 23, 59, 59} },
        { 2015, 1, 12, 23, 59, 59, {2015, 1, 12, 23, 59, 59} },
        { 2015, 1, 13, 23, 59, 59, {2015, 1, 13, 23, 59, 59} },
        { 2015, 1, 14, 23, 59, 59, {2015, 1, 14, 23, 59, 59} },
        { 2015, 1, 15, 23, 59, 59, {2015, 1, 15, 23, 59, 59} },
        { 2015, 1, 16, 23, 59, 59, {2015, 1, 16, 23, 59, 59} },
        { 2015, 1, 17, 23, 59, 59, {2015, 1, 17, 23, 59, 59} },
        { 2015, 1, 18, 23, 59, 59, {2015, 1, 18, 23, 59, 59} },
        { 2015, 1, 19, 23, 59, 59, {2015, 1, 19, 23, 59, 59} },
        { 2015, 1, 20, 23, 59, 59, {2015, 1, 20, 23, 59, 59} },
        { 2015, 1, 21, 23, 59, 59, {2015, 1, 21, 23, 59, 59} },
        { 2015, 1, 22, 23, 59, 59, {2015, 1, 22, 23, 59, 59} },
        { 2015, 1, 23, 23, 59, 59, {2015, 1, 23, 23, 59, 59} },
        { 2015, 1, 24, 23, 59, 59, {2015, 1, 24, 23, 59, 59} },
        { 2015, 1, 25, 23, 59, 59, {2015, 1, 25, 23, 59, 59} },
        { 2015, 1, 26, 23, 59, 59, {2015, 1, 26, 23, 59, 59} },
        { 2015, 1, 27, 23, 59, 59, {2015, 1, 27, 23, 59, 59} },
        { 2015, 1, 28, 23, 59, 59, {2015, 1, 28, 23, 59, 59} },
        { 2015, 1, 29, 23, 59, 59, {2015, 1, 29, 23, 59, 59} },
        { 2015, 1, 30, 23, 59, 59, {2015, 1, 30, 23, 59, 59} },
        { 2015, 1, 31, 23, 59, 59, {2015, 1, 31, 23, 59, 59} },

        /* test Feb-29th of leap years */

        {  104, 2, 29,  0,  0,  0,  { 104, 2, 29,  0,  0,  0} },
        /* min leap yr */

        { 1908, 2, 29,  0,  0,  0,  {1908, 2, 29,  0,  0,  0} },
        { 2012, 2, 29,  0,  0,  0,  {2012, 2, 29,  0,  0,  0} },

        { 9996, 2, 29,  0,  0,  0,  {9996, 2, 29,  0,  0,  0} },
        /* max leap yr */

        {  104, 2, 29, 11, 22, 33,  { 104, 2, 29, 11, 22, 33} },
        /* min leap yr */

        { 1908, 2, 29, 11, 22, 33,  {1908, 2, 29, 11, 22, 33} },
        { 2012, 2, 29, 11, 22, 33,  {2012, 2, 29, 11, 22, 33} },

        { 9996, 2, 29, 11, 22, 33,  {9996, 2, 29, 11, 22, 33} },
        /* max leap yr */

        {  104, 2, 29, 23, 59, 59,  { 104, 2, 29, 23, 59, 59} },
        /* min leap yr */

        { 1908, 2, 29, 23, 59, 59,  {1908, 2, 29, 23, 59, 59} },
        { 2012, 2, 29, 23, 59, 59,  {2012, 2, 29, 23, 59, 59} },
        { 9996, 2, 29, 23, 59, 59,  {9996, 2, 29, 23, 59, 59} },
        /* max leap yr */

        /* invalid dates (result in a null date/time object) */

        {     0,  0, 0, 0, 0, 0, NULL_DATE },  /* null */

        {    -1,  1, 1, 0, 0, 0, NULL_DATE },  /* invalid year */
        { 10000,  1, 1, 0, 0, 0, NULL_DATE },

        { 2015,  0, 1, 0, 0, 0, NULL_DATE },  /* invalid month */
        { 2015, -1, 1, 0, 0, 0, NULL_DATE },
        { 2015, 13, 1, 0, 0, 0, NULL_DATE },
        { 2015, 99, 1, 0, 0, 0, NULL_DATE },

        { 2015,  1, 32, 0, 0, 0, NULL_DATE },  /* invalid day of month */
        { 2015,  2, 29, 0, 0, 0, NULL_DATE },
        { 2015,  3, 32, 0, 0, 0, NULL_DATE },
        { 2015,  4, 31, 0, 0, 0, NULL_DATE },
        { 2015,  5, 32, 0, 0, 0, NULL_DATE },
        { 2015,  6, 31, 0, 0, 0, NULL_DATE },
        { 2015,  7, 32, 0, 0, 0, NULL_DATE },
        { 2015,  8, 32, 0, 0, 0, NULL_DATE },
        { 2015,  9, 31, 0, 0, 0, NULL_DATE },
        { 2015, 10, 32, 0, 0, 0, NULL_DATE },
        { 2015, 11, 31, 0, 0, 0, NULL_DATE },
        { 2015, 12, 32, 0, 0, 0, NULL_DATE },

        { 2015,  1, -1, 0, 0, 0, NULL_DATE },  /* invalid day */
        { 2015,  1,  0, 0, 0, 0, NULL_DATE },
        { 2015,  1, 99, 0, 0, 0, NULL_DATE },

        { 2015,  1,  1, -1, 0, 0, NULL_DATE },  /* invalid hour */
        { 2015,  1,  1, 24, 0, 0, NULL_DATE },

        { 2015,  1,  1, 0, -1, 0, NULL_DATE },  /* invalid minute */
        { 2015,  1,  1, 0, 60, 0, NULL_DATE },

        { 2015,  1,  1, 0, 0, -1, NULL_DATE },  /* invalid second */
        { 2015,  1,  1, 0, 0, 60, NULL_DATE },

        { 0xFFFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, NULL_DATE }  /* stop */
    };
    int  i = 0;
    do {
        const int      year_   = tests[i].year_;
        const int      month_  = tests[i].month_;
        const int      day_    = tests[i].day_;
        const int      hour_   = tests[i].hour_;
        const int      minute_ = tests[i].minute_;
        const int      second_ = tests[i].second_;
        const dtime_t  check   = tests[i].check;
        const dtime_t  result
            = dtime_init(year_, month_, day_, hour_, minute_, second_);

        if (!DTIME_EQUAL(check, result)) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (0xFFFF != tests[++i].year_);
} /* _test_dtime */


/* Construct the object from a text string.                                   */
PUBLIC dtime_t  dtime_chars( chars_t  text_ );                             /*C*/

static void  _test_dtime_chars( void ) {                                   /*F*/
    static struct  _test_t {
        chars_t  text_;
        dtime_t  check;
    }
    const  tests[] = {

        /* failing tests: */
        /* { _T("29 feb "),     {2029,  2,  1, 0, 0, 0} }, */  /* FAIL */
        /* { _T("1 2 pm "),     {0, 0, 0, 0, 0, 0} },      */  /* non-date */
        /* { _T("pm10 5 aug"),  {2015, 8, 5,  0, 0, 0} },  */
        /* { _T("1,0,2"),       {1900, 4, 11, 0, 0, 0} },  */
        /* { _T("10:00 jun"),   {0, 0, 0, 0, 0, 0} },      */ /* non-date */
        /* { _T("11jan"),       {0, 0, 0, 0, 0, 0} },      */
        /* { _T("9 10 11 jan"), {0, 0, 0, 0, 0, 0} },      */ /* non-date*/
        /* { _T("June 25th"),   {0, 0, 0, 0, 0, 0} },      */

        /* standard date formats: */

        /* hh:mm */
        { _T("00:00"), {0, 0, 0,  0,  0, 0} },
        { _T("12:34"), {0, 0, 0, 12, 34, 0} },
        { _T("19:06"), {0, 0, 0, 19,  6, 0} },
        { _T("23:59"), {0, 0, 0, 23, 59, 0} },

        /* hh:mm:ss */
        { _T("00:00:00"), {0, 0, 0,  0,  0,  0} },
        { _T("00:00:01"), {0, 0, 0,  0,  0,  1} },
        { _T("12:34:56"), {0, 0, 0, 12, 34, 56} },
        { _T("19:06:30"), {0, 0, 0, 19,  6, 30} },
        { _T("23:59:59"), {0, 0, 0, 23, 59, 59} },

        /* YYY-MM-DD */
        { _T("000-00-00"), {  0,  0,  0, 0, 0, 0} },
        { _T("100-01-01"), {100,  1,  1, 0, 0, 0} },
        { _T("100-12-31"), {100, 12, 31, 0, 0, 0} },
        { _T("999-12-31"), {999, 12, 31, 0, 0, 0} },

        /* YYYY-MM-DD */
        { _T("0000-00-00"), {   0,  0,  0, 0, 0, 0} },
        { _T("0001-02-03"), {2001,  2,  3, 0, 0, 0} },
        { _T("0049-02-03"), {2049,  2,  3, 0, 0, 0} },
        { _T("0050-02-03"), {1950,  2,  3, 0, 0, 0} },
        { _T("2015-11-16"), {2015, 11, 16, 0, 0, 0} },
        { _T("9999-12-31"), {9999, 12, 31, 0, 0, 0} },

        /* YYY-MM-DD hh:mm */
        { _T("000-00-00 00:00"), {  0,  0,  0,  0,  0, 0} },
        { _T("100-12-31 23:59"), {100, 12, 31, 23, 59, 0} },
        { _T("999-12-31 23:59"), {999, 12, 31, 23, 59, 0} },

        /* YYYY-MM-DD hh:mm */
        { _T("0000-00-00 00:00"), {   0,  0,  0,  0,  0, 0} },
        { _T("2015-11-16 19:06"), {2015, 11, 16, 19,  6, 0} },
        { _T("9999-12-31 12:34"), {9999, 12, 31, 12, 34, 0} },
        { _T("9999-12-31 23:59"), {9999, 12, 31, 23, 59, 0} },

        /* YYY-MM-DD hh:mm:ss */
        { _T("000-00-00 00:00:00"), {  0,  0,  0,  0,  0,  0} },
        { _T("100-12-31 23:59:58"), {100, 12, 31, 23, 59, 58} },
        { _T("999-12-31 12:34:56"), {999, 12, 31, 12, 34, 56} },
        { _T("999-12-31 23:59:58"), {999, 12, 31, 23, 59, 58} },

        /* YYYY-MM-DD hh:mm:ss */
        { _T("0000-00-00 00:00:00"), {   0,  0,  0,  0, 0,  0} },
        { _T("2015-11-16 19:06:30"), {2015, 11, 16, 19, 6, 30} },

        /* misc. tests: */
        { _T("0,1,2"),        {2000,  1,   2,  0, 0, 0} },
        { _T("01/12/31"),     {2001, 12,  31,  0, 0, 0} },
        { _T("01-Oct-2015"),  {2015, 10,   1,  0, 0, 0} },
        { _T("1 , 2 , 3 "),   {2001,  2,   3,  0, 0, 0} },
        { _T("1 2 3 pm "),    {2015,  1,   2, 15, 0, 0} },
        { _T("1 2 3"),        {2001,  2,   3,  0, 0, 0} },
        { _T("1 2 JAN "),     {2001,  1,   2,  0, 0, 0} },
        { _T("1 june 2"),     {2001,  6,   2,  0, 0, 0} },
        { _T("1, 2, 3"),      {2001,  2,   3,  0, 0, 0} },
        { _T("1,14,3"),       {2003,  1,  14,  0, 0, 0} },
        { _T("1,2,14"),       {2001,  2,  14,  0, 0, 0} },
        { _T("1,2,3"),        {2001,  2,   3,  0, 0, 0} },
        { _T("10:00 7 jun"),  {2015,  6,   7, 10, 0, 0} },
        { _T("10pm 5 aug"),   {2015,  8,   5, 22, 0, 0} },
        { _T("1-2-3"),        {2001,  2,   3,  0, 0, 0} },
        { _T("14,2,3"),       {2014,  2,   3,  0, 0, 0} },
        { _T("15-12-01"),     {2015,  12, 01,  0, 0, 0} },
        { _T("jan 2 3 am"),   {2015,  1,   2,  3, 0, 0} },
        { _T("jan 2 3 pm"),   {2015,  1,   2, 15, 0, 0} },
        { _T("June 25 15"),   {2025,  6,  15,  0, 0, 0} },
        { _T("Mar, 10 2015"), {2015,  3,  10,  0, 0, 0} },

        /* special cases: */
        { _T("1,2,0"), {2000, 1,  2, 0, 0, 0} },

        /* note the rules for date/time parsing (only DMY, MDY and YMD work): */
        { _T("01/13/2015"), {2015, 1, 13, 0, 0, 0} },  /* DMY */
        { _T("13/01/2015"), {2015, 1, 13, 0, 0, 0} },  /* MDY */
        { _T("2015/01/13"), {2015, 1, 13, 0, 0, 0} },  /* YMD */

        /* year ranges */
        { _T("00/12/31"), {2000, 12, 31, 0, 0, 0} },
        { _T("32/12/31"), {2032, 12, 31, 0, 0, 0} },
        { _T("46/12/31"), {2046, 12, 31, 0, 0, 0} },
        { _T("49/12/31"), {2049, 12, 31, 0, 0, 0} },
        { _T("50/12/31"), {1950, 12, 31, 0, 0, 0} },
        { _T("76/12/31"), {1976, 12, 31, 0, 0, 0} },
        { _T("99/12/31"), {1999, 12, 31, 0, 0, 0} },

        { _T("00-12-31"), {2000, 12, 31, 0, 0, 0} },
        { _T("01-12-31"), {2001, 12, 31, 0, 0, 0} },
        { _T("49-12-31"), {2049, 12, 31, 0, 0, 0} },
        { _T("50-12-31"), {1950, 12, 31, 0, 0, 0} },
        { _T("99-12-31"), {1999, 12, 31, 0, 0, 0} },

        /* leap years */

        { _T("02/29/104 "), { 104, 2, 29, 0, 0, 0} },  /* min leap yr */
        { _T("02/29/1908"), {1908, 2, 29, 0, 0, 0} },
        { _T("02/29/2012"), {2012, 2, 29, 0, 0, 0} },
        { _T("02/29/9996"), {9996, 2, 29, 0, 0, 0} },  /* max leap yr */

        { _T("0104-02-29"), { 104, 2, 29, 0, 0, 0} },  /* min leap yr */
        { _T("1908-02-29"), {1908, 2, 29, 0, 0, 0} },
        { _T("2012-02-29"), {2012, 2, 29, 0, 0, 0} },
        { _T("9996-02-29"), {9996, 2, 29, 0, 0, 0} },  /* max leap yr */

        /* dates using combinations of separators and spaces */
        { _T("10 / jun - 2015 "), {2015, 6, 10, 0, 0, 0} },
        { _T("10 /jun-2015 "),    {2015, 6, 10, 0, 0, 0} },
        { _T("10 jun-2015 "),     {2015, 6, 10, 0, 0, 0} },
        { _T("10/ jun-2015 "),    {2015, 6, 10, 0, 0, 0} },
        { _T("10/jun-2015 "),     {2015, 6, 10, 0, 0, 0} },
        { _T("10 jun-2015"),      {2015, 6, 10, 0, 0, 0} },
        { _T("10/jun-2015"),      {2015, 6, 10, 0, 0, 0} },

        { _T("10 11 12 "),    {2010, 11, 12, 0, 0, 0} },
        { _T("10-11-12 "),    {2010, 11, 12, 0, 0, 0} },
        { _T("10 - 11 / 12"), {2010, 11, 12, 0, 0, 0} },
        { _T("10 11 12"),     {2010, 11, 12, 0, 0, 0} },
        { _T("10/11/12"),     {2010, 11, 12, 0, 0, 0} },

        { _T("12:34:56"), {0, 0, 0, 12, 34, 56} },
        { _T("2:2 "),     {0, 0, 0,  2,  2,  0} },
        { _T("13 : 30"),  {0, 0, 0, 13, 30,  0} },
        { _T("23 am"),    {0, 0, 0, 23,  0,  0} },
        { _T("23 pm"),    {0, 0, 0, 23,  0,  0} },
        { _T("23am"),     {0, 0, 0, 23,  0,  0} },
        { _T("23pm"),     {0, 0, 0, 23,  0,  0} },
        { _T("5 am"),     {0, 0, 0,  5,  0,  0} },
        { _T("5 pm"),     {0, 0, 0, 17,  0,  0} },
        { _T("5am"),      {0, 0, 0,  5,  0,  0} },
        { _T("5pm"),      {0, 0, 0, 17,  0,  0} },

        /* both date and time specified */
        { _T("10:00 jan 1"),         {2015,  1,  1, 10,  0,  0} },
        { _T("28/feb 5:30pm"),       {YEAR,  2, 28, 17, 30,  0} },
        { _T("12/31/9999 23:59:59"), {9999, 12, 31, 23, 59, 59} },

        /* partial dates */
        { _T("1 23 "),   {YEAR,  1, 23, 0, 0, 0} },
        { _T("12 nov "), {YEAR, 11, 12, 0, 0, 0} },
        { _T("12 NOV "), {YEAR, 11, 12, 0, 0, 0} },
        { _T("29 feb "), {2029,  2,  1, 0, 0, 0} },
        { _T("29 FEB "), {2029,  2,  1, 0, 0, 0} },
        { _T("feb 29 "), {2029,  2,  1, 0, 0, 0} },
        { _T("FEB 29 "), {2029,  2,  1, 0, 0, 0} },
        { _T("nov 12 "), {YEAR, 11, 12, 0, 0, 0} },
        { _T("NOV 12 "), {YEAR, 11, 12, 0, 0, 0} },
        { _T("12 nov"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("12 NOV"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("12/nov"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("12/NOV"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("12-nov"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("12-NOV"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("29 feb"),  {2029,  2,  1, 0, 0, 0} },
        { _T("29 FEB"),  {2029,  2,  1, 0, 0, 0} },
        { _T("29/feb"),  {2029,  2,  1, 0, 0, 0} },
        { _T("29/FEB"),  {2029,  2,  1, 0, 0, 0} },
        { _T("29-feb"),  {2029,  2,  1, 0, 0, 0} },
        { _T("29-FEB"),  {2029,  2,  1, 0, 0, 0} },
        { _T("feb 29"),  {2029,  2,  1, 0, 0, 0} },
        { _T("FEB 29"),  {2029,  2,  1, 0, 0, 0} },
        { _T("feb/29"),  {2029,  2,  1, 0, 0, 0} },
        { _T("FEB/29"),  {2029,  2,  1, 0, 0, 0} },
        { _T("feb-29"),  {2029,  2,  1, 0, 0, 0} },
        { _T("FEB-29"),  {2029,  2,  1, 0, 0, 0} },
        { _T("nov 12"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("NOV 12"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("nov/12"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("NOV/12"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("nov-12"),  {YEAR, 11, 12, 0, 0, 0} },
        { _T("NOV-12"),  {YEAR, 11, 12, 0, 0, 0} },

        /* non-date strings */
        { _T(" "),           {0, 0, 0, 0, 0, 0} },
        { _T(""),            {0, 0, 0, 0, 0, 0} },
        { _T("-"),           {0, 0, 0, 0, 0, 0} },
        { _T("--"),          {0, 0, 0, 0, 0, 0} },
        { _T(":10:00"),      {0, 0, 0, 0, 0, 0} },
        { _T("\\"),          {0, 0, 0, 0, 0, 0} },
        { _T("\\\\"),        {0, 0, 0, 0, 0, 0} },
        { _T("01/2015/13"),  {0, 0, 0, 0, 0, 0} },  /* DYM* */
        { _T("0-13-01"),     {0, 0, 0, 0, 0, 0} },
        { _T("10:00:"),      {0, 0, 0, 0, 0, 0} },
        { _T("100-14-01"),   {0, 0, 0, 0, 0, 0} },
        { _T("100-31-12"),   {0, 0, 0, 0, 0, 0} },
        { _T("13 am am"),    {0, 0, 0, 0, 0, 0} },
        { _T("13 am pm"),    {0, 0, 0, 0, 0, 0} },
        { _T("13/2015/01"),  {0, 0, 0, 0, 0, 0} },  /* MYD* */
        { _T("2015/13/01"),  {0, 0, 0, 0, 0, 0} },  /* YDM* */
        { _T("2015-13-01"),  {0, 0, 0, 0, 0, 0} },
        { _T("9 10 11 12"),  {0, 0, 0, 0, 0, 0} },
        { _T("ABC"),         {0, 0, 0, 0, 0, 0} },
        { _T("am 8"),        {0, 0, 0, 0, 0, 0} },
        { _T("am"),          {0, 0, 0, 0, 0, 0} },
        { _T("jan jan 1"),   {0, 0, 0, 0, 0, 0} },
        { _T("pm 9"),        {0, 0, 0, 0, 0, 0} },
        { _T("pm"),          {0, 0, 0, 0, 0, 0} },

        { NULL, {0, 0, 0, 0, 0, 0} }  /* stop */
    };
    int  i = 0;
    do {
        chars_t        text_  = tests[i].text_;
        dtime_t        check  = tests[i].check;
        const dtime_t  result = dtime_chars(text_);

        if (check.year == YEAR ) {
            check.year = dtime_now().year;
        }

        if (!DTIME_EQUAL(check, result)) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (tests[++i].text_ != NULL);
} /* _test_dtime_chars */


/* Return the current local date and time.                                    */
PUBLIC dtime_t  dtime_now( void );                                         /*C*/

static void  _test_dtime_now( void ) {                                     /*F*/
    const dtime_t  result = dtime_now();

    if (!is_valid_dtime(&result)) {
        DEBUG_BREAK;    /*  T E S T   F A I L E D  */
    }

    if (result.year < 2015 || result.year   > 9999 ||
        result.month  < 1  || result.month  > 12   ||
        result.day    < 1  ||
        result.month  > days_in_month(result.year, result.month) ||
        result.hour   > 23 ||
        result.minute > 59 ||
        result.second > 59) {
        DEBUG_BREAK;    /*  T E S T   F A I L E D  */
    }

    /* ensure time returned by the function actually changes with time */
    {
        size_t      i     = 10000000;
        dtime_t  time2 = dtime_now();

        while (DTIME_EQUAL(time2, result) && i > 0) {
            time2 = dtime_now();
            i--;
        }

        if (DTIME_EQUAL(time2, result)) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    }
} /* _test_dtime_now */


/* Construct a dtime_t object from a floating-point number.                */
PUBLIC dtime_t  dtime_value( const double  value_ );                       /*C*/

static void  _test_dtime_value( void ) {                                   /*F*/
    static struct  _test_t {
        double  value_;
        dtime_t  check;
    }
    const  tests[] = {
        { -657434,            { 100,  1,  1,  0,  0,  0}  },
        { 0,                  {1899, 12, 30,  0,  0,  0}  },
        { 42355.473993055602, {2015, 12, 17, 11, 22, 33}  },
        { 2958465.99998843,   {9999, 12, 31, 23, 59, 59}  },

        { 0,                  {0, 0, 0, 0, 0, 0} }  /* stop */
    };
    int  i = 0;
    do {
        const double   value_ = tests[i].value_;
        const dtime_t  check  = tests[i].check;
        const dtime_t  result = dtime_value(value_);

        if (!DTIME_EQUAL(result, check)) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (tests[++i].check.year != 0);
} /* _test_dtime_value */


/* -------------------------------------------------------------------------- */
/* Methods/Properties:                                                        */


/* Return a formatted string. (e.g. specify "%HH:%NN:%SS")                    */
PUBLIC dtime_str_t  format_dtime(                                          /*M*/
    const dtime_t* const  object_,                                         /*-*/
    chars_t               format_ );                                       /*-*/

static void  _format_dtime( void ) {                                       /*F*/
    static struct  _test_t {
        dtime_t  object_;
        chars_t  format_;
        chars_t  check;
    }
    const  tests[] = {

        /* if '%' is not in the format, just returns the string as-is */
        { {1234, 12, 31, 14, 25, 36}, _T("hh:nn:ss"), _T("hh:nn:ss") },

        /* ISO-8601 date with time */
        {   { 2001, 05, 07,  4, 55, 16}, _T("%yyyy-%mm-%ddT%hh:%nn:%ss"),
            _T("2001-05-07T04:55:16")
        },

        /* ISO-8601 dates without time */
        { { 100,  2,  3,  4, 59, 56}, _T("%yyyy-%mm-%dd"), _T("0100-02-03") },
        { {1896, 12, 11, 23, 59, 44}, _T("%yyyy-%mm-%dd"), _T("1896-12-11") },

        /* long month names */
        { { 2015,  1,  1,  0,  0,  0}, _T("%mmmm"),      _T("january") },
        { { 2015,  1,  1,  0,  0,  0}, _T("%Mmmm"),      _T("January") },
        { { 2015,  1,  1,  0,  0,  0}, _T("%MMmm"),      _T("JANUARY") },

        /* days */
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {2015,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },

        { {2015,  1,  1, 14, 45, 36}, _T("%d"),  _T("1") },
        { {2015,  1,  2, 14, 45, 36}, _T("%d"),  _T("2") },
        { {2015,  1,  3, 14, 45, 36}, _T("%d"),  _T("3") },
        { {2015,  1,  4, 14, 45, 36}, _T("%d"),  _T("4") },
        { {2015,  1,  5, 14, 45, 36}, _T("%d"),  _T("5") },
        { {2015,  1,  6, 14, 45, 36}, _T("%d"),  _T("6") },
        { {2015,  1,  7, 14, 45, 36}, _T("%d"),  _T("7") },
        { {2015,  1,  8, 14, 45, 36}, _T("%d"),  _T("8") },
        { {2015,  1,  9, 14, 45, 36}, _T("%d"),  _T("9") },
        { {2015,  1, 10, 14, 45, 36}, _T("%d"), _T("10") },
        { {2015,  1, 11, 14, 45, 36}, _T("%d"), _T("11") },
        { {2015,  1, 12, 14, 45, 36}, _T("%d"), _T("12") },
        { {2015,  1, 13, 14, 45, 36}, _T("%d"), _T("13") },
        { {2015,  1, 14, 14, 45, 36}, _T("%d"), _T("14") },
        { {2015,  1, 15, 14, 45, 36}, _T("%d"), _T("15") },
        { {2015,  1, 16, 14, 45, 36}, _T("%d"), _T("16") },
        { {2015,  1, 17, 14, 45, 36}, _T("%d"), _T("17") },
        { {2015,  1, 18, 14, 45, 36}, _T("%d"), _T("18") },
        { {2015,  1, 19, 14, 45, 36}, _T("%d"), _T("19") },
        { {2015,  1, 20, 14, 45, 36}, _T("%d"), _T("20") },
        { {2015,  1, 21, 14, 45, 36}, _T("%d"), _T("21") },
        { {2015,  1, 22, 14, 45, 36}, _T("%d"), _T("22") },
        { {2015,  1, 23, 14, 45, 36}, _T("%d"), _T("23") },
        { {2015,  1, 24, 14, 45, 36}, _T("%d"), _T("24") },
        { {2015,  1, 25, 14, 45, 36}, _T("%d"), _T("25") },
        { {2015,  1, 26, 14, 45, 36}, _T("%d"), _T("26") },
        { {2015,  1, 27, 14, 45, 36}, _T("%d"), _T("27") },
        { {2015,  1, 28, 14, 45, 36}, _T("%d"), _T("28") },
        { {2015,  1, 29, 14, 45, 36}, _T("%d"), _T("29") },
        { {2015,  1, 30, 14, 45, 36}, _T("%d"), _T("30") },
        { {2015,  1, 31, 14, 45, 36}, _T("%d"), _T("31") },

        { {2015,  1,  1, 14, 45, 36}, _T("%D"),  _T("1") },
        { {2015,  1,  2, 14, 45, 36}, _T("%D"),  _T("2") },
        { {2015,  1,  3, 14, 45, 36}, _T("%D"),  _T("3") },
        { {2015,  1,  4, 14, 45, 36}, _T("%D"),  _T("4") },
        { {2015,  1,  5, 14, 45, 36}, _T("%D"),  _T("5") },
        { {2015,  1,  6, 14, 45, 36}, _T("%D"),  _T("6") },
        { {2015,  1,  7, 14, 45, 36}, _T("%D"),  _T("7") },
        { {2015,  1,  8, 14, 45, 36}, _T("%D"),  _T("8") },
        { {2015,  1,  9, 14, 45, 36}, _T("%D"),  _T("9") },
        { {2015,  1, 10, 14, 45, 36}, _T("%D"), _T("10") },
        { {2015,  1, 11, 14, 45, 36}, _T("%D"), _T("11") },
        { {2015,  1, 12, 14, 45, 36}, _T("%D"), _T("12") },
        { {2015,  1, 13, 14, 45, 36}, _T("%D"), _T("13") },
        { {2015,  1, 14, 14, 45, 36}, _T("%D"), _T("14") },
        { {2015,  1, 15, 14, 45, 36}, _T("%D"), _T("15") },
        { {2015,  1, 16, 14, 45, 36}, _T("%D"), _T("16") },
        { {2015,  1, 17, 14, 45, 36}, _T("%D"), _T("17") },
        { {2015,  1, 18, 14, 45, 36}, _T("%D"), _T("18") },
        { {2015,  1, 19, 14, 45, 36}, _T("%D"), _T("19") },
        { {2015,  1, 20, 14, 45, 36}, _T("%D"), _T("20") },
        { {2015,  1, 21, 14, 45, 36}, _T("%D"), _T("21") },
        { {2015,  1, 22, 14, 45, 36}, _T("%D"), _T("22") },
        { {2015,  1, 23, 14, 45, 36}, _T("%D"), _T("23") },
        { {2015,  1, 24, 14, 45, 36}, _T("%D"), _T("24") },
        { {2015,  1, 25, 14, 45, 36}, _T("%D"), _T("25") },
        { {2015,  1, 26, 14, 45, 36}, _T("%D"), _T("26") },
        { {2015,  1, 27, 14, 45, 36}, _T("%D"), _T("27") },
        { {2015,  1, 28, 14, 45, 36}, _T("%D"), _T("28") },
        { {2015,  1, 29, 14, 45, 36}, _T("%D"), _T("29") },
        { {2015,  1, 30, 14, 45, 36}, _T("%D"), _T("30") },
        { {2015,  1, 31, 14, 45, 36}, _T("%D"), _T("31") },

        { {2015,  1,  1, 14, 45, 36}, _T("%dd"), _T("01") },
        { {2015,  1,  2, 14, 45, 36}, _T("%dd"), _T("02") },
        { {2015,  1,  3, 14, 45, 36}, _T("%dd"), _T("03") },
        { {2015,  1,  4, 14, 45, 36}, _T("%dd"), _T("04") },
        { {2015,  1,  5, 14, 45, 36}, _T("%dd"), _T("05") },
        { {2015,  1,  6, 14, 45, 36}, _T("%dd"), _T("06") },
        { {2015,  1,  7, 14, 45, 36}, _T("%dd"), _T("07") },
        { {2015,  1,  8, 14, 45, 36}, _T("%dd"), _T("08") },
        { {2015,  1,  9, 14, 45, 36}, _T("%dd"), _T("09") },
        { {2015,  1, 10, 14, 45, 36}, _T("%dd"), _T("10") },
        { {2015,  1, 11, 14, 45, 36}, _T("%dd"), _T("11") },
        { {2015,  1, 12, 14, 45, 36}, _T("%dd"), _T("12") },
        { {2015,  1, 13, 14, 45, 36}, _T("%dd"), _T("13") },
        { {2015,  1, 14, 14, 45, 36}, _T("%dd"), _T("14") },
        { {2015,  1, 15, 14, 45, 36}, _T("%dd"), _T("15") },
        { {2015,  1, 16, 14, 45, 36}, _T("%dd"), _T("16") },
        { {2015,  1, 17, 14, 45, 36}, _T("%dd"), _T("17") },
        { {2015,  1, 18, 14, 45, 36}, _T("%dd"), _T("18") },
        { {2015,  1, 19, 14, 45, 36}, _T("%dd"), _T("19") },
        { {2015,  1, 20, 14, 45, 36}, _T("%dd"), _T("20") },
        { {2015,  1, 21, 14, 45, 36}, _T("%dd"), _T("21") },
        { {2015,  1, 22, 14, 45, 36}, _T("%dd"), _T("22") },
        { {2015,  1, 23, 14, 45, 36}, _T("%dd"), _T("23") },
        { {2015,  1, 24, 14, 45, 36}, _T("%dd"), _T("24") },
        { {2015,  1, 25, 14, 45, 36}, _T("%dd"), _T("25") },
        { {2015,  1, 26, 14, 45, 36}, _T("%dd"), _T("26") },
        { {2015,  1, 27, 14, 45, 36}, _T("%dd"), _T("27") },
        { {2015,  1, 28, 14, 45, 36}, _T("%dd"), _T("28") },
        { {2015,  1, 29, 14, 45, 36}, _T("%dd"), _T("29") },
        { {2015,  1, 30, 14, 45, 36}, _T("%dd"), _T("30") },
        { {2015,  1, 31, 14, 45, 36}, _T("%dd"), _T("31") },

        { {2015,  1,  1, 14, 45, 36}, _T("%DD"), _T("01") },
        { {2015,  1,  2, 14, 45, 36}, _T("%DD"), _T("02") },
        { {2015,  1,  3, 14, 45, 36}, _T("%DD"), _T("03") },
        { {2015,  1,  4, 14, 45, 36}, _T("%DD"), _T("04") },
        { {2015,  1,  5, 14, 45, 36}, _T("%DD"), _T("05") },
        { {2015,  1,  6, 14, 45, 36}, _T("%DD"), _T("06") },
        { {2015,  1,  7, 14, 45, 36}, _T("%DD"), _T("07") },
        { {2015,  1,  8, 14, 45, 36}, _T("%DD"), _T("08") },
        { {2015,  1,  9, 14, 45, 36}, _T("%DD"), _T("09") },
        { {2015,  1, 10, 14, 45, 36}, _T("%DD"), _T("10") },
        { {2015,  1, 11, 14, 45, 36}, _T("%DD"), _T("11") },
        { {2015,  1, 12, 14, 45, 36}, _T("%DD"), _T("12") },
        { {2015,  1, 13, 14, 45, 36}, _T("%DD"), _T("13") },
        { {2015,  1, 14, 14, 45, 36}, _T("%DD"), _T("14") },
        { {2015,  1, 15, 14, 45, 36}, _T("%DD"), _T("15") },
        { {2015,  1, 16, 14, 45, 36}, _T("%DD"), _T("16") },
        { {2015,  1, 17, 14, 45, 36}, _T("%DD"), _T("17") },
        { {2015,  1, 18, 14, 45, 36}, _T("%DD"), _T("18") },
        { {2015,  1, 19, 14, 45, 36}, _T("%DD"), _T("19") },
        { {2015,  1, 20, 14, 45, 36}, _T("%DD"), _T("20") },
        { {2015,  1, 21, 14, 45, 36}, _T("%DD"), _T("21") },
        { {2015,  1, 22, 14, 45, 36}, _T("%DD"), _T("22") },
        { {2015,  1, 23, 14, 45, 36}, _T("%DD"), _T("23") },
        { {2015,  1, 24, 14, 45, 36}, _T("%DD"), _T("24") },
        { {2015,  1, 25, 14, 45, 36}, _T("%DD"), _T("25") },
        { {2015,  1, 26, 14, 45, 36}, _T("%DD"), _T("26") },
        { {2015,  1, 27, 14, 45, 36}, _T("%DD"), _T("27") },
        { {2015,  1, 28, 14, 45, 36}, _T("%DD"), _T("28") },
        { {2015,  1, 29, 14, 45, 36}, _T("%DD"), _T("29") },
        { {2015,  1, 30, 14, 45, 36}, _T("%DD"), _T("30") },
        { {2015,  1, 31, 14, 45, 36}, _T("%DD"), _T("31") },

        { {2015, 12,  1, 14, 45, 36}, _T("%ddd"), _T("tue") },
        { {2015, 12,  2, 14, 45, 36}, _T("%ddd"), _T("wed") },
        { {2015, 12,  3, 14, 45, 36}, _T("%ddd"), _T("thu") },
        { {2015, 12,  4, 14, 45, 36}, _T("%ddd"), _T("fri") },
        { {2015, 12,  5, 14, 45, 36}, _T("%ddd"), _T("sat") },
        { {2015, 12,  6, 14, 45, 36}, _T("%ddd"), _T("sun") },
        { {2015, 12,  7, 14, 45, 36}, _T("%ddd"), _T("mon") },

        { {2015, 12,  1, 14, 45, 36}, _T("%Ddd"), _T("Tue") },
        { {2015, 12,  2, 14, 45, 36}, _T("%Ddd"), _T("Wed") },
        { {2015, 12,  3, 14, 45, 36}, _T("%Ddd"), _T("Thu") },
        { {2015, 12,  4, 14, 45, 36}, _T("%Ddd"), _T("Fri") },
        { {2015, 12,  5, 14, 45, 36}, _T("%Ddd"), _T("Sat") },
        { {2015, 12,  6, 14, 45, 36}, _T("%Ddd"), _T("Sun") },
        { {2015, 12,  7, 14, 45, 36}, _T("%Ddd"), _T("Mon") },

        { {2015, 12,  1, 14, 45, 36}, _T("%DDD"), _T("TUE") },
        { {2015, 12,  2, 14, 45, 36}, _T("%DDD"), _T("WED") },
        { {2015, 12,  3, 14, 45, 36}, _T("%DDD"), _T("THU") },
        { {2015, 12,  4, 14, 45, 36}, _T("%DDD"), _T("FRI") },
        { {2015, 12,  5, 14, 45, 36}, _T("%DDD"), _T("SAT") },
        { {2015, 12,  6, 14, 45, 36}, _T("%DDD"), _T("SUN") },
        { {2015, 12,  7, 14, 45, 36}, _T("%DDD"), _T("MON") },

        { {2015, 12,  1, 14, 45, 36}, _T("%dddd"), _T("tuesday")   },
        { {2015, 12,  2, 14, 45, 36}, _T("%dddd"), _T("wednesday") },
        { {2015, 12,  3, 14, 45, 36}, _T("%dddd"), _T("thursday")  },
        { {2015, 12,  4, 14, 45, 36}, _T("%dddd"), _T("friday")    },
        { {2015, 12,  5, 14, 45, 36}, _T("%dddd"), _T("saturday")  },
        { {2015, 12,  6, 14, 45, 36}, _T("%dddd"), _T("sunday")    },
        { {2015, 12,  7, 14, 45, 36}, _T("%dddd"), _T("monday")    },

        { {2015, 12,  1, 14, 45, 36}, _T("%Dddd"), _T("Tuesday")   },
        { {2015, 12,  2, 14, 45, 36}, _T("%Dddd"), _T("Wednesday") },
        { {2015, 12,  3, 14, 45, 36}, _T("%Dddd"), _T("Thursday")  },
        { {2015, 12,  4, 14, 45, 36}, _T("%Dddd"), _T("Friday")    },
        { {2015, 12,  5, 14, 45, 36}, _T("%Dddd"), _T("Saturday")  },
        { {2015, 12,  6, 14, 45, 36}, _T("%Dddd"), _T("Sunday")    },
        { {2015, 12,  7, 14, 45, 36}, _T("%Dddd"), _T("Monday")    },

        { {2015, 12,  1, 14, 45, 36}, _T("%DDDD"), _T("TUESDAY")   },
        { {2015, 12,  2, 14, 45, 36}, _T("%DDDD"), _T("WEDNESDAY") },
        { {2015, 12,  3, 14, 45, 36}, _T("%DDDD"), _T("THURSDAY")  },
        { {2015, 12,  4, 14, 45, 36}, _T("%DDDD"), _T("FRIDAY")    },
        { {2015, 12,  5, 14, 45, 36}, _T("%DDDD"), _T("SATURDAY")  },
        { {2015, 12,  6, 14, 45, 36}, _T("%DDDD"), _T("SUNDAY")    },
        { {2015, 12,  7, 14, 45, 36}, _T("%DDDD"), _T("MONDAY")    },

        { {2015, 12,  1, 14, 45, 36}, _T("%ddddd"), _T("tuesday")   },
        { {2015, 12,  2, 14, 45, 36}, _T("%ddddd"), _T("wednesday") },
        { {2015, 12,  3, 14, 45, 36}, _T("%ddddd"), _T("thursday")  },
        { {2015, 12,  4, 14, 45, 36}, _T("%ddddd"), _T("friday")    },
        { {2015, 12,  5, 14, 45, 36}, _T("%ddddd"), _T("saturday")  },
        { {2015, 12,  6, 14, 45, 36}, _T("%ddddd"), _T("sunday")    },
        { {2015, 12,  7, 14, 45, 36}, _T("%ddddd"), _T("monday")    },

        { {2015, 12,  1, 14, 45, 36}, _T("%Ddddd"), _T("Tuesday")   },
        { {2015, 12,  2, 14, 45, 36}, _T("%Ddddd"), _T("Wednesday") },
        { {2015, 12,  3, 14, 45, 36}, _T("%Ddddd"), _T("Thursday")  },
        { {2015, 12,  4, 14, 45, 36}, _T("%Ddddd"), _T("Friday")    },
        { {2015, 12,  5, 14, 45, 36}, _T("%Ddddd"), _T("Saturday")  },
        { {2015, 12,  6, 14, 45, 36}, _T("%Ddddd"), _T("Sunday")    },
        { {2015, 12,  7, 14, 45, 36}, _T("%Ddddd"), _T("Monday")    },

        { {2015, 12,  1, 14, 45, 36}, _T("%DDDDD"), _T("TUESDAY")   },
        { {2015, 12,  2, 14, 45, 36}, _T("%DDDDD"), _T("WEDNESDAY") },
        { {2015, 12,  3, 14, 45, 36}, _T("%DDDDD"), _T("THURSDAY")  },
        { {2015, 12,  4, 14, 45, 36}, _T("%DDDDD"), _T("FRIDAY")    },
        { {2015, 12,  5, 14, 45, 36}, _T("%DDDDD"), _T("SATURDAY")  },
        { {2015, 12,  6, 14, 45, 36}, _T("%DDDDD"), _T("SUNDAY")    },
        { {2015, 12,  7, 14, 45, 36}, _T("%DDDDD"), _T("MONDAY")    },

        /* months */

        { {1234,  1, 25, 14, 45, 36}, _T("%m"),      _T("1") },
        { {1234,  2, 25, 14, 45, 36}, _T("%m"),      _T("2") },
        { {1234,  3, 25, 14, 45, 36}, _T("%m"),      _T("3") },
        { {1234,  4, 25, 14, 45, 36}, _T("%m"),      _T("4") },
        { {1234,  5, 25, 14, 45, 36}, _T("%m"),      _T("5") },
        { {1234,  6, 25, 14, 45, 36}, _T("%m"),      _T("6") },
        { {1234,  7, 25, 14, 45, 36}, _T("%m"),      _T("7") },
        { {1234,  8, 25, 14, 45, 36}, _T("%m"),      _T("8") },
        { {1234,  9, 25, 14, 45, 36}, _T("%m"),      _T("9") },
        { {1234, 10, 25, 14, 45, 36}, _T("%m"),      _T("10") },
        { {1234, 11, 25, 14, 45, 36}, _T("%m"),      _T("11") },
        { {1234, 12, 25, 14, 45, 36}, _T("%m"),      _T("12") },

        { {1234,  1, 25, 14, 45, 36}, _T("%M"),      _T("1") },
        { {1234,  2, 25, 14, 45, 36}, _T("%M"),      _T("2") },
        { {1234,  3, 25, 14, 45, 36}, _T("%M"),      _T("3") },
        { {1234,  4, 25, 14, 45, 36}, _T("%M"),      _T("4") },
        { {1234,  5, 25, 14, 45, 36}, _T("%M"),      _T("5") },
        { {1234,  6, 25, 14, 45, 36}, _T("%M"),      _T("6") },
        { {1234,  7, 25, 14, 45, 36}, _T("%M"),      _T("7") },
        { {1234,  8, 25, 14, 45, 36}, _T("%M"),      _T("8") },
        { {1234,  9, 25, 14, 45, 36}, _T("%M"),      _T("9") },
        { {1234, 10, 25, 14, 45, 36}, _T("%M"),      _T("10") },
        { {1234, 11, 25, 14, 45, 36}, _T("%M"),      _T("11") },
        { {1234, 12, 25, 14, 45, 36}, _T("%M"),      _T("12") },

        { {1234,  1, 25, 14, 45, 36}, _T("%mm"),      _T("01") },
        { {1234,  2, 25, 14, 45, 36}, _T("%mm"),      _T("02") },
        { {1234,  3, 25, 14, 45, 36}, _T("%mm"),      _T("03") },
        { {1234,  4, 25, 14, 45, 36}, _T("%mm"),      _T("04") },
        { {1234,  5, 25, 14, 45, 36}, _T("%mm"),      _T("05") },
        { {1234,  6, 25, 14, 45, 36}, _T("%mm"),      _T("06") },
        { {1234,  7, 25, 14, 45, 36}, _T("%mm"),      _T("07") },
        { {1234,  8, 25, 14, 45, 36}, _T("%mm"),      _T("08") },
        { {1234,  9, 25, 14, 45, 36}, _T("%mm"),      _T("09") },
        { {1234, 10, 25, 14, 45, 36}, _T("%mm"),      _T("10") },
        { {1234, 11, 25, 14, 45, 36}, _T("%mm"),      _T("11") },
        { {1234, 12, 25, 14, 45, 36}, _T("%mm"),      _T("12") },

        { {1234,  1, 25, 14, 45, 36}, _T("%Mm"),      _T("01") },
        { {1234,  2, 25, 14, 45, 36}, _T("%Mm"),      _T("02") },
        { {1234,  3, 25, 14, 45, 36}, _T("%Mm"),      _T("03") },
        { {1234,  4, 25, 14, 45, 36}, _T("%Mm"),      _T("04") },
        { {1234,  5, 25, 14, 45, 36}, _T("%Mm"),      _T("05") },
        { {1234,  6, 25, 14, 45, 36}, _T("%Mm"),      _T("06") },
        { {1234,  7, 25, 14, 45, 36}, _T("%Mm"),      _T("07") },
        { {1234,  8, 25, 14, 45, 36}, _T("%Mm"),      _T("08") },
        { {1234,  9, 25, 14, 45, 36}, _T("%Mm"),      _T("09") },
        { {1234, 10, 25, 14, 45, 36}, _T("%Mm"),      _T("10") },
        { {1234, 11, 25, 14, 45, 36}, _T("%Mm"),      _T("11") },
        { {1234, 12, 25, 14, 45, 36}, _T("%Mm"),      _T("12") },

        { {1234,  1, 25, 14, 45, 36}, _T("%MM"),      _T("01") },
        { {1234,  2, 25, 14, 45, 36}, _T("%MM"),      _T("02") },
        { {1234,  3, 25, 14, 45, 36}, _T("%MM"),      _T("03") },
        { {1234,  4, 25, 14, 45, 36}, _T("%MM"),      _T("04") },
        { {1234,  5, 25, 14, 45, 36}, _T("%MM"),      _T("05") },
        { {1234,  6, 25, 14, 45, 36}, _T("%MM"),      _T("06") },
        { {1234,  7, 25, 14, 45, 36}, _T("%MM"),      _T("07") },
        { {1234,  8, 25, 14, 45, 36}, _T("%MM"),      _T("08") },
        { {1234,  9, 25, 14, 45, 36}, _T("%MM"),      _T("09") },
        { {1234, 10, 25, 14, 45, 36}, _T("%MM"),      _T("10") },
        { {1234, 11, 25, 14, 45, 36}, _T("%MM"),      _T("11") },
        { {1234, 12, 25, 14, 45, 36}, _T("%MM"),      _T("12") },

        { {1234,  1, 25, 14, 45, 36}, _T("%mmm"),      _T("jan") },
        { {1234,  2, 25, 14, 45, 36}, _T("%mmm"),      _T("feb") },
        { {1234,  3, 25, 14, 45, 36}, _T("%mmm"),      _T("mar") },
        { {1234,  4, 25, 14, 45, 36}, _T("%mmm"),      _T("apr") },
        { {1234,  5, 25, 14, 45, 36}, _T("%mmm"),      _T("may") },
        { {1234,  6, 25, 14, 45, 36}, _T("%mmm"),      _T("jun") },
        { {1234,  7, 25, 14, 45, 36}, _T("%mmm"),      _T("jul") },
        { {1234,  8, 25, 14, 45, 36}, _T("%mmm"),      _T("aug") },
        { {1234,  9, 25, 14, 45, 36}, _T("%mmm"),      _T("sep") },
        { {1234, 10, 25, 14, 45, 36}, _T("%mmm"),      _T("oct") },
        { {1234, 11, 25, 14, 45, 36}, _T("%mmm"),      _T("nov") },
        { {1234, 12, 25, 14, 45, 36}, _T("%mmm"),      _T("dec") },

        { {1234,  1, 25, 14, 45, 36}, _T("%Mmm"),      _T("Jan") },
        { {1234,  2, 25, 14, 45, 36}, _T("%Mmm"),      _T("Feb") },
        { {1234,  3, 25, 14, 45, 36}, _T("%Mmm"),      _T("Mar") },
        { {1234,  4, 25, 14, 45, 36}, _T("%Mmm"),      _T("Apr") },
        { {1234,  5, 25, 14, 45, 36}, _T("%Mmm"),      _T("May") },
        { {1234,  6, 25, 14, 45, 36}, _T("%Mmm"),      _T("Jun") },
        { {1234,  7, 25, 14, 45, 36}, _T("%Mmm"),      _T("Jul") },
        { {1234,  8, 25, 14, 45, 36}, _T("%Mmm"),      _T("Aug") },
        { {1234,  9, 25, 14, 45, 36}, _T("%Mmm"),      _T("Sep") },
        { {1234, 10, 25, 14, 45, 36}, _T("%Mmm"),      _T("Oct") },
        { {1234, 11, 25, 14, 45, 36}, _T("%Mmm"),      _T("Nov") },
        { {1234, 12, 25, 14, 45, 36}, _T("%Mmm"),      _T("Dec") },

        { {1234,  1, 25, 14, 45, 36}, _T("%MMM"),      _T("JAN") },
        { {1234,  2, 25, 14, 45, 36}, _T("%MMM"),      _T("FEB") },
        { {1234,  3, 25, 14, 45, 36}, _T("%MMM"),      _T("MAR") },
        { {1234,  4, 25, 14, 45, 36}, _T("%MMM"),      _T("APR") },
        { {1234,  5, 25, 14, 45, 36}, _T("%MMM"),      _T("MAY") },
        { {1234,  6, 25, 14, 45, 36}, _T("%MMM"),      _T("JUN") },
        { {1234,  7, 25, 14, 45, 36}, _T("%MMM"),      _T("JUL") },
        { {1234,  8, 25, 14, 45, 36}, _T("%MMM"),      _T("AUG") },
        { {1234,  9, 25, 14, 45, 36}, _T("%MMM"),      _T("SEP") },
        { {1234, 10, 25, 14, 45, 36}, _T("%MMM"),      _T("OCT") },
        { {1234, 11, 25, 14, 45, 36}, _T("%MMM"),      _T("NOV") },
        { {1234, 12, 25, 14, 45, 36}, _T("%MMM"),      _T("DEC") },

        { {1234,  1, 25, 14, 45, 36}, _T("%mmmm"),      _T("january") },
        { {1234,  2, 25, 14, 45, 36}, _T("%mmmm"),      _T("february") },
        { {1234,  3, 25, 14, 45, 36}, _T("%mmmm"),      _T("march") },
        { {1234,  4, 25, 14, 45, 36}, _T("%mmmm"),      _T("april") },
        { {1234,  5, 25, 14, 45, 36}, _T("%mmmm"),      _T("may") },
        { {1234,  6, 25, 14, 45, 36}, _T("%mmmm"),      _T("june") },
        { {1234,  7, 25, 14, 45, 36}, _T("%mmmm"),      _T("july") },
        { {1234,  8, 25, 14, 45, 36}, _T("%mmmm"),      _T("august") },
        { {1234,  9, 25, 14, 45, 36}, _T("%mmmm"),      _T("september") },
        { {1234, 10, 25, 14, 45, 36}, _T("%mmmm"),      _T("october") },
        { {1234, 11, 25, 14, 45, 36}, _T("%mmmm"),      _T("november") },
        { {1234, 12, 25, 14, 45, 36}, _T("%mmmm"),      _T("december") },

        { {1234,  1, 25, 14, 45, 36}, _T("%Mmmm"),      _T("January") },
        { {1234,  2, 25, 14, 45, 36}, _T("%Mmmm"),      _T("February") },
        { {1234,  3, 25, 14, 45, 36}, _T("%Mmmm"),      _T("March") },
        { {1234,  4, 25, 14, 45, 36}, _T("%Mmmm"),      _T("April") },
        { {1234,  5, 25, 14, 45, 36}, _T("%Mmmm"),      _T("May") },
        { {1234,  6, 25, 14, 45, 36}, _T("%Mmmm"),      _T("June") },
        { {1234,  7, 25, 14, 45, 36}, _T("%Mmmm"),      _T("July") },
        { {1234,  8, 25, 14, 45, 36}, _T("%Mmmm"),      _T("August") },
        { {1234,  9, 25, 14, 45, 36}, _T("%Mmmm"),      _T("September") },
        { {1234, 10, 25, 14, 45, 36}, _T("%Mmmm"),      _T("October") },
        { {1234, 11, 25, 14, 45, 36}, _T("%Mmmm"),      _T("November") },
        { {1234, 12, 25, 14, 45, 36}, _T("%Mmmm"),      _T("December") },

        { {1234,  1, 25, 14, 45, 36}, _T("%MMMM"),      _T("JANUARY") },
        { {1234,  2, 25, 14, 45, 36}, _T("%MMMM"),      _T("FEBRUARY") },
        { {1234,  3, 25, 14, 45, 36}, _T("%MMMM"),      _T("MARCH") },
        { {1234,  4, 25, 14, 45, 36}, _T("%MMMM"),      _T("APRIL") },
        { {1234,  5, 25, 14, 45, 36}, _T("%MMMM"),      _T("MAY") },
        { {1234,  6, 25, 14, 45, 36}, _T("%MMMM"),      _T("JUNE") },
        { {1234,  7, 25, 14, 45, 36}, _T("%MMMM"),      _T("JULY") },
        { {1234,  8, 25, 14, 45, 36}, _T("%MMMM"),      _T("AUGUST") },
        { {1234,  9, 25, 14, 45, 36}, _T("%MMMM"),      _T("SEPTEMBER") },
        { {1234, 10, 25, 14, 45, 36}, _T("%MMMM"),      _T("OCTOBER") },
        { {1234, 11, 25, 14, 45, 36}, _T("%MMMM"),      _T("NOVEMBER") },
        { {1234, 12, 25, 14, 45, 36}, _T("%MMMM"),      _T("DECEMBER") },

        { {    0,  1,  1,  0,  0,  0}, _T("year:%yyyy"), _T("year:0000") },
        { {  100,  1,  1,  0,  0,  0}, _T("year:%yyyy"), _T("year:0100") },
        { { 2015,  1,  1,  0,  0,  0}, _T("year:%yyyy"), _T("year:2015") },

        { {    1,  2,  3,  4, 55, 16}, _T("%hh:%nn:%ss"), _T("04:55:16") },
        { {    0,  1,  1,  0,  0,  0}, _T("year:%yyyy"), _T("year:0000") },

        { {0, 0, 0, 0, 0, 0}, NULL, NULL }  /* stop */
    };
    int  i = 0;
    do {
        const dtime_t  object_ = tests[i].object_;
        chars_t        format_ = tests[i].format_;
        chars_t        check   = tests[i].check;
        dtime_str_t    result;

        if (i == -1) {
            DEBUG_BREAK;
        }

        result = format_dtime(&object_, format_);

        if (STRCMP_T(result.cs, check) != 0) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (tests[++i].format_ != NULL);
} /* _format_dtime */


/* Return a floating-point number based on given object. (date-only)          */
PUBLIC double  value_date( const dtime_t* const  object_ );                /*M*/

static void  _test_value_date( void ) {                                    /*F*/
    static struct  _test_t {
        dtime_t  object_;
        double  check;
    }
    const  tests[] = {
        { { 100,  1,  1,  0,  0,  0}, -657434 },
        { { 100,  1,  1,  0,  0,  1}, -657434 },
        { { 100,  1,  1, 23, 59, 59}, -657434 },
        { {1899, 12, 30,  0,  0,  0}, 0       },
        { {2015, 12, 17, 11, 22, 33}, 42355   },
        { {9999, 12, 31,  0,  0,  0}, 2958465 },
        { {9999, 12, 31,  0,  0,  1}, 2958465 },
        { {9999, 12, 31, 23, 59, 59}, 2958465 },

        { {0, 0, 0, 0, 0, 0}, 0 }  /* stop */
    };
    int  i = 0;
    do {
        const dtime_t  object_ = tests[i].object_;
        const double   check   = tests[i].check;
        const double   result  = value_date(&object_);
        const double   diff    = result - check;

        if (diff < -1e-8 || diff > 1e-8) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (tests[++i].object_.year != 0);
} /* _test_value_date */


/* Return a floating-point number based on given object.                      */
PUBLIC double  value_dtime( const dtime_t* const  object_ );               /*M*/

static void  _test_value_dtime( void ) {                                   /*F*/
    static struct  _test_t {
        dtime_t  object_;
        double  check;
    }
    const  tests[] = {
        { { 100,  1,  1,  0,  0,  0}, -657434            },
        { {1899, 12, 30,  0,  0,  0}, 0                  },
        { {2015, 12, 17, 11, 22, 33}, 42355.473993055602 },
        { {9999, 12, 31, 23, 59, 59}, 2958465.99998843   },

        { {0, 0, 0, 0, 0, 0}, 0 }  /* stop */
    };
    int  i = 0;
    do {
        const dtime_t  object_ = tests[i].object_;
        const double   check   = tests[i].check;
        const double   result  = value_dtime(&object_);
        const double   diff    = result - check;

        if (diff < -1e-8 || diff > 1e-8) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (tests[++i].object_.year != 0);
} /* _test_value_dtime */


/* -------------------------------------------------------------------------- */
/* Functions:                                                                 */


PUBLIC dtime_str_t  timespan( int  seconds_ );                             /*F*/

static void  _test_lx_timespan( void ) {                                   /*F*/
    static struct  _test_t {
        int  seconds_;
        chars_t  check;
    }
    const  tests[] = {
        {         0, _T("0 seconds")              },
        {         1, _T("1 second")               },
        {         2, _T("2 seconds")              },
        {        59, _T("59 seconds")             },
        {        60, _T("1 minute")               },
        {        61, _T("1 minute 1 second")      },
        {        90, _T("1 minute 30 seconds")    },
        {       120, _T("2 minutes")              },
        {      3600, _T("1 hour")                 },
        {     10000, _T("2 hours 46 minutes")     },
        {     86399, _T("23 hours 59 minutes")    },
        {     86400, _T("1 day")                  },
        {   1000000, _T("1 week 4 days")          },
        {   INT_MAX, _T("3550 weeks 5 days")      },
        { -1, NULL }  /* stop */
    };
    int  i = 0;
    do {
        const int           seconds_ = tests[i].seconds_;
        chars_t             check    = tests[i].check;
        const  dtime_str_t  result   = timespan(seconds_);

        if (STRCMP_T(result.cs, check) != 0) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (tests[++i].check != NULL);
} /* _test_lx_timespan */


/* Return the day of week num. from the given date, ranging from 1 for Monday */
/* to 7 for Sunday (ISO-8601 weekday), or 0 if the given date is not valid.   */
PUBLIC uint8_t  weekday(                                                   /*F*/
    const int  year_,                                                      /*-*/
    const int  month_,                                                     /*-*/
    const int  day_ );                                                     /*-*/

static void  _test_weekday( void ) {                                       /*F*/
    static struct  _test_t {
        int year_;
        int month_;
        int day_;
        uint8_t check;
    }
    const  tests[] = {
        {  100,  1,  1, 5 },  /* Fri */
        {  104,  2, 29, 5 },  /* Fri */
        { 1899, 12, 30, 6 },  /* Sat */
        { 1908,  2, 29, 6 },  /* Sat */
        { 2012,  2, 29, 3 },  /* Wed */
        { 2015,  1,  1, 4 },  /* Thu */
        { 2015,  1,  2, 5 },  /* Fri */
        { 2015,  1,  3, 6 },  /* Sat */
        { 2015,  1,  4, 7 },  /* Sun */
        { 2015,  1,  5, 1 },  /* Mon */
        { 2015,  1,  6, 2 },  /* Tue */
        { 2015,  1,  7, 3 },  /* Wed */
        { 9996,  2, 29, 4 },  /* Thu */
        { 9999, 12, 31, 5 },  /* Fri */

        { 1, 1, 1, 0xFF }    /* stop */
    };
    int  i = 0;
    do {
        const int      year_  = tests[i].year_;
        const int      month_ = tests[i].month_;
        const int      day_   = tests[i].day_;
        const uint8_t  check  = tests[i].check;
        const uint8_t  result = weekday(year_, month_, day_);

        if (check != result) {
            DEBUG_BREAK;    /*  T E S T   F A I L E D  */
        }
    } while (0xFF != tests[++i].check);
} /* _test_weekday */


/* -------------------------------------------------------------------------- */

PUBLIC void  test_dtime_class( void );                                     /*F*/
PUBLIC void  test_dtime_class( void ) {                                    /*F*/
    GO                                                            (UID(F6C7B3));
    _format_dtime();;;

    /* Constructors */
    _test_lx_date();
    _test_dtime_init();
    _test_dtime_chars();
    _test_dtime_now();
    _test_dtime_value();

    /* Methods/Properties */
    _test_value_date();
    _test_value_dtime();

    /* Functions */
    _test_lx_timespan();
    _test_weekday();

    RETURN(NIL);
} /* test_dtime_class */


#endif                                                                   /*eof*/
